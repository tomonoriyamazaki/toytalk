# toytalk
SS Bootcamp 3rd #2025

## プロジェクト
- 声をかけると返答してくれるAIおもちゃの作成
- 目的は親の時間確保
- 子供がおもちゃに夢中になると同時に、言葉のキャッチボール力の向上もできたらうれしい
- OpenAIのAPIを利用するため、会話のたびに料金が発生する
- APIキーを発行してセットすれば、課金分のみの利用が可能
- APIキーの設定が面倒であれば、月額課金でも利用できる
- 無料で使用することも可能。会話はできないが、ただおうむ返しをしたり、事前にセットした昔話を話してくれる、という機能もあると親としては助かる（実際はサーバー維持費用かかるので検討中）
- おもちゃイメージ　「まねっこぴょこぴょこアンパンマン」
  - https://www.amazon.co.jp/gp/product/B0B4RQ85ZQ/ref=sw_img_1?smid=AN1VRQENFRJN5&th=1


## 音声会話のしくみ
  1. STT（音声→テキスト）
  2. LLM
  3. TTS（テキスト→音声）

前提として
  - OpenAIのAPIキーが必要。API利用のたびに課金が発生する
  - ユーザーがキー設定と料金管理をするために、専用のスマホアプリが必要


## PJの流れ
- デモサイト構築：マイク→音声→テキスト→LLM→音声返答してくれるサイトを作る　→一旦完了
- ラズパイに落とし込む
- スマホアプリを作って、ユーザー側でAPIキーを設定できるようにする
- おもちゃとしてデザインを決めて形にする
一旦ここまで出来たらうれしい

サービス化するなら
- 何よりも速度が課題：デモサイト上では1往復で5秒前後かかる。。AWS上だから？ラズパイにするともっと遅くなるかも
  - STT：ここが足を引っ張っているように感じる。websocket通信で高速化できないか検討中　※ここをブラウザのテキスト化機能にしたら（つまりSSTをなくしたら）、往復で1-4秒と速度アップした
  - LLM：4.1-miniを利用。かなり早いはず
  - TTS：回答内容をまとめてmp3にしている？ためか長文だと時間かかるように感じる。子供向けということで、LLMの回答内容をシンプルにすることで短縮できないか
  - ※groqが爆速らしい
  - ※最悪難しかったら、待ってる間に「相槌を打つ」機能の追加を検討。「そうだね～」、「なるほどね」、「ふむふむ」とかいろいろなパターンを使って時間を稼げないか検討
- アプリ上で課金管理をできるようにする
- 会話するうえで、メモリに会話履歴をためる必要がある。どこでどうやって解放するか設計・実装（会話積み重ねると重くなる）
- 月額課金にする場合のAPIキー管理の仕組みを設計・実装
- 無料で利用する場合のおうむ返し機能、昔話をしてくれる機能の設計・実装
- ボイスとテンションを子供向けにする

## デモサイト
- https://toytalk.zakicorp.com/demo/index.html


## 構成図
サーバーレスでAWS上に構築
- デモ
![image](https://github.com/user-attachments/assets/17ba02fb-200f-44a9-a990-9b352dcf7615)


### 補足：APIGWのCORS設定
| 設定項目                               | 開発中 | 本番             |
| ---------------------------------- | --------- | ------------------------------ |
| `Access-Control-Allow-Credentials` | （なし）      | `true`（必要なら）                   |
| CloudFront キャッシュキー                 | （特になし）    | `Origin` を含めて設定                |

